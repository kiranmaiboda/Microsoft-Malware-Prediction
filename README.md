![Malware Logo](/images/malware.jpg)
# <u> Microsoft Malware Prediction - Capstone project
*The malware industry continues to be a well-organized, well-funded market dedicated to evading traditional security measures. Once a computer is infected by malware, criminals can hurt consumers and enterprises in many ways.
With more than one billion enterprise and consumer customers, Microsoft takes this problem very seriously and is deeply invested in improving security. To develop techniques to predict if a machine will soon be hit with malware.*
# <u> 1. Data
To predict a Windows machine’s probability of getting infected by various families of malware, based on different properties of that machine. The telemetry data containing these properties and the machine infections was generated by combining heartbeat and threat reports collected by Microsoft's endpoint protection solution, Windows Defender.

Each row in this dataset corresponds to a machine, uniquely identified by a MachineIdentifier. HasDetections is the ground truth and indicates that Malware was detected on the machine. Using the information and labels in train.csv, you must predict the value for HasDetections for each machine in test.csv.

The sampling methodology used to create this dataset was designed to meet certain business constraints, both in regards to user privacy as well as the time period during which the machine was running. Malware detection is inherently a time-series problem, but it is made complicated by the introduction of new machines, machines that come online and offline, machines that receive patches, machines that receive new operating systems, etc. While the dataset provided here has been roughly split by time, the complications and sampling requirements mentioned above may mean you may see imperfect agreement between your cross validation, public, and private scores! Additionally, this dataset is not representative of Microsoft customers’ machines in the wild; it has been sampled to include a much larger proportion of malware machines.To import/view the dataset click the link below.
* [Dataset](https://www.kaggle.com/c/microsoft-malware-prediction/data)
# <u> 2. Data Wrangling
## <u> 2.1 Introduction
  This step focuses on collecting our data, organizing it, and making sure it's well defined. Paying attention to these tasks will pay off greatly later on. Some data cleaning can be done at this stage, but it's important not to be overzealous in your cleaning before you've explored the data to better understand it.
## <u> 2.2 Objectives
  * Before we start cleaning we must better understand what is in our data, which will inform how we want to analyze it.
  * Organizing the data, which is necessary because raw data comes in many different shapes and sizes.
  * Removing outliers and filling missing values.
## <u> 2.3 Data cleaning
  Because of the manganomonity of the data, my system facing issues to load the dataset. So to reduce the loading time we tried using dtype while reading the csv file. We have nearly 9 million rows where each row represents a system that runs on windows os. And it has totally 83 features (columns) that specify entire information about systems. We have a target variable, HasDetections which is a boolean. If it’s 1 - malware is in the system else no malware.
  
  Due to more features and rows, It’s better to get rid of those columns that won’t help our prediction model. Started by checking the number of null values in each column and calculated null values percentages per column.
  
  ![missing values](https://github.com/kiranmaiboda/Microsoft-Malware-Prediction/blob/main/images/missing%20values.png)
  
  Dropped all those features whose null values percentage was more than 60%.Then checked for high cardinality columns and dropped them too.Pandas profiling package helped in dropping those columns as it provided a report on each column. Left with 75 features, the next target is to eliminate nulls from the remaining features. It was handled by imputing most frequent values in categorical and mean in numerical columns by mostly mean or mode.
  ## <u> 2.4 Correlation Matrix
  Using the cleaned data frame and selecting numeric features from it, generated a correlation matrix.
 1. Found out the correlation of features with target variable, and sorted the values in descending order, and it can be seen from above results that AVproductsstateIdentifier highly correlated with the target variable in terms of positive strength and AVProductsInstalled in terms of negative strength followed by CensusTotalPhysicalRAM and ISProtected etc in terms of positive strength and Census_IsAlwaysonALwaysConnectedCapable and so on in terms of negative strength
2. Using above results, it will be useful for creating new features or feature engineering from above given features. Like for example as AVproductsstateIdentifier and AvproductsInstalled are highly correlated with target variable then using those features we can create new feature using feature engineering hack.
  # <u> 3. Exploratory Data Analysis (EDA)
  We are left with 75 features and nearly 9 million rows to understand the data and bring out some insights in a presentable format. As we know we can visualise all types of columns in the same way. I have decided to segregate features into 3 types, Boolean, Numeric and Categorical data. By doing so we left with 17 - Boolean columns, 37 - Categorical columns and 18 - Numerical columns.
  ## <u> 3.1 Boolean columns
  As it has only 2 outputs and our target variable also has only 2 outputs. So, Came up with a visualisation technique where we first split using the target variable and then split on the boolean column to get insights. Let’s see an example of column IsBeta which can be On(1) or Off(0). IsBeta functionality is that if we enable it, windows will helps to keep your computer protected from current threats are automatically downloaded and protect from malware attacks.
  ![IsBeta bool](/images/IsBeta.png)
  We can interpret this as follows: When IsBeta is not enabled, Malware attacks are equally distributed informing that IsBeta - 0 is not affecting the target variable. But, then the image on right is telling a different story. We see a significant decrease in Malware Detected bar, To be precise it has fallen from 50 to 15%. This infers that SMode when enabled, reduces the chance of being attacked by malware.
